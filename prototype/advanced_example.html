<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>MarkerClusterer v3 Advanced Example</title>

    <style>
      body {
        margin: 0;
        padding: 10px 20px 20px;
        font-family: Arial;
        font-size: 16px;
      }
      #map-container {
        padding: 6px;
        border-width: 1px;
        border-style: solid;
        border-color: #ccc #ccc #999 #ccc;
        -webkit-box-shadow: rgba(64, 64, 64, 0.5) 0 2px 5px;
        -moz-box-shadow: rgba(64, 64, 64, 0.5) 0 2px 5px;
        box-shadow: rgba(64, 64, 64, 0.1) 0 2px 5px;
        width: 800px;
      }
      #map {
        width: 800px;
        height: 400px;
      }
      #actions {
        list-style: none;
        padding: 0;
      }
      #inline-actions {
        padding-top: 10px;
      }
      .item {
        margin-left: 20px;
      }
    </style>

    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBddRPtIQIxETvq5c9kzaZ82l3m00QWvQ8">
    </script>
     <script src="js/lib/jquery-3.1.0.min.js"></script>
    <script type="text/javascript" src="js/lib/markerclusterer.js"></script>
    <script src="js/lib/json-requestor.js"></script>
    <script>

      // AJAX_JSON_Req('hosts.json').done(function (q) {
      //   console.log(q); blah = q
      // });
      var classrooms /* classrooms data table*/

      $.getJSON( 'hosts.json', function() {
        console.log( "success" );
      }).done(function(data) {
        console.log( "second success", data );
        classrooms = data;
        buildMap();
      })

      function buildMap(){

        var style = null;
        var markerClusterer = null;
        var map = null;

        var imageUrl = 'http://chart.apis.google.com/chart?cht=mm&chs=24x32&' +
            'chco=FFFFFF,008CFF,000000&ext=.png';

        function refreshMap() {
          if (markerClusterer) {
            markerClusterer.clearMarkers();
          }

          var markers = [];

          var markerImage = new google.maps.MarkerImage(imageUrl,
            new google.maps.Size(24, 32));

          for (var i = 0; i < 1000; ++i) {
            var latLng = new google.maps.LatLng(classrooms[i].latitude,
                classrooms[i].longitude)
            var marker = new google.maps.Marker({
              position: latLng,
              draggable: false,
              icon: markerImage
            });
            markers.push(marker);
          }

          zoom = 10
          size = 60
          markerClusterer = new MarkerClusterer(map, markers, {
            maxZoom: zoom,
            gridSize: size,
            imagePath: 'images/m'
          });
        }

        function initialize() {
          map = new google.maps.Map(document.getElementById('map'), {
            zoom: 2,
            center: new google.maps.LatLng(39.91, 116.38),
            mapTypeId: google.maps.MapTypeId.ROADMAP
          });

          refreshMap();
        }

        function clearClusters(e) {
          e.preventDefault();
          e.stopPropagation();
          markerClusterer.clearMarkers();
        }

        google.maps.event.addDomListener(window, 'load', initialize);
      }
    </script>
  </head>
  <body>
    <div id="map-container">
      <div id="map"></div>
    </div>
  </body>
</html>
